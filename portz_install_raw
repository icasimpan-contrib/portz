#
# This file is part of 'portz'
#
# Copyright (C) Zbigniew Zagorski <z.zagorski@gmail.com> and others, 
# licensed to the public under the terms of the GNU GPL (>= 2)
# see the file COPYING for details
#
# I.e., do what you like, but keep copyright and there's NO WARRANTY. 
# 

set -e -x
PNAME=`basename $0`
portz_root=`pwd`
. $portz_root/portz_common.sh

url=$1

inform "installing from source url: $url"
archive=`portz_need_source $url`
inform "got archive: $archive"

tmpsrcdir=/tmp/portz_build/$package
rm -rf $tmpsrcdir
mkdir -p $tmpsrcdir
pushd $tmpsrcdir
inform "unpacking to $tmpsrcdir"

portz_unarchive $archive
goto_srcdir
srcdir=`pwd`

inform "building $package in $PWD"
if ( set -x ; install ; ) ; then
    popd
    rm -rf $tmpsrcdir
else
    fail "build/install failed, check build at $srcdir"
fi
